import{_ as s,c as a,o as i,U as t}from"./chunks/framework.lgX5_p8q.js";const E=JSON.parse('{"title":"Attachments","description":"","frontmatter":{},"headers":[],"relativePath":"ru/guide/attachments.md","filePath":"ru/guide/attachments.md"}'),e={name:"ru/guide/attachments.md"},n=t(`<h1 id="attachments" tabindex="-1">Attachments <a class="header-anchor" href="#attachments" aria-label="Permalink to &quot;Attachments&quot;">​</a></h1><p>Описание принципов работы с прикреплениями</p><h2 id="описание-типов" tabindex="-1">Описание типов <a class="header-anchor" href="#описание-типов" aria-label="Permalink to &quot;Описание типов&quot;">​</a></h2><p><a href="https://negezor.github.io/vk-io/references/vk-io/classes/Attachment.html" target="_blank" rel="noreferrer">Attachment API Reference [EN]</a><a href="https://negezor.github.io/vk-io/references/vk-io/classes/ExternalAttachment.html" target="_blank" rel="noreferrer">ExternalAttachment API Reference [EN]</a></p><h2 id="концепция" tabindex="-1">Концепция <a class="header-anchor" href="#концепция" aria-label="Permalink to &quot;Концепция&quot;">​</a></h2><p>Есть два базовых класса для работы с прикреплениями:</p><ul><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/Attachment.html" target="_blank" rel="noreferrer">Attachment</a> — основной класс, может быть прикреплением <code>attachment1234_1234_1234</code><ul><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/PollAttachment.html" target="_blank" rel="noreferrer">PollAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/WallAttachment.html" target="_blank" rel="noreferrer">WallAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/PhotoAttachment.html" target="_blank" rel="noreferrer">PhotoAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/AudioAttachment.html" target="_blank" rel="noreferrer">AudioAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/StoryAttachment.html" target="_blank" rel="noreferrer">StoryAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/VideoAttachment.html" target="_blank" rel="noreferrer">VideoAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/MarketAttachment.html" target="_blank" rel="noreferrer">MarketAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/GraffitiAttachment.html" target="_blank" rel="noreferrer">GraffitiAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/DocumentAttachment.html" target="_blank" rel="noreferrer">DocumentAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/MarketAlbumAttachment.html" target="_blank" rel="noreferrer">MarketAlbumAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/AudioMessageAttachment.html" target="_blank" rel="noreferrer">AudioMessageAttachment</a></li></ul></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/ExternalAttachment.html" target="_blank" rel="noreferrer">ExternalAttachment</a> второстепенный класс, без возможности прикрепления. Обычно можно получить только с самого ВКонтакте API. <ul><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/GiftAttachment.html" target="_blank" rel="noreferrer">GiftAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/LinkAttachment.html" target="_blank" rel="noreferrer">LinkAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/StickerAttachment.html" target="_blank" rel="noreferrer">StickerAttachment</a></li><li><a href="https://negezor.github.io/vk-io/references/vk-io/classes/WallReplyAttachment.html" target="_blank" rel="noreferrer">WallReplyAttachment</a></li></ul></li></ul><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> attachment</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Attachment</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // api,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    type: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;photo&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    payload: {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        owner_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">100</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        // access_key: &#39;accessKey&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// attachment.isFilled(); // =&gt; false</span></span></code></pre></div><p>Формат прикреплений ВКонтакте очень простой: <code>\${type}\${ownerId}_\${id}_\${accessKey}</code>. В основном идёт работа без ключа доступа (<code>_\${accessKey}</code>), пример прикрепления фотографии с ID <code>1</code>, которая принадлежит пользователю с ID <code>100</code> (<code>photo100_1</code>). Несколько прикреплений передаются через запятую <code>photo100_1,doc100_5</code>.</p><p>Вы можете вручную получать такой формат, например для всех прикреплений <code>\${attachment.type}\${attachment.ownerId}_\${attachment.id}</code>. Но это делать не нужно, так как у класса <a href="https://negezor.github.io/vk-io/references/vk-io/classes/Attachment.html" target="_blank" rel="noreferrer">Attachment</a> есть метод <a href="https://negezor.github.io/vk-io/references/vk-io/classes/Attachment.html#toString" target="_blank" rel="noreferrer">toString</a>, он автоматический вёрнёт данный формат.</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">attachment.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// photo100_1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Или</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(attachment); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// photo100_1</span></span></code></pre></div><p>Это так же будет работать с массивами при приведении их к строке</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[attachment, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;doc100_5&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">toString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// photo100_1,doc100_5</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Или</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">String</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">([attachment, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;doc100_5&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// photo100_1,doc100_5</span></span></code></pre></div><p>Помимо ручного преобразования, мы можем положиться на автоматическое приведение к строке в методах API</p><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> api.messages.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    peer_id: &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">peer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Здесь будет photo100_1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    attachment</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Ручное преобразование одного прикрепления</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // attachment: attachment.toString()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // attachment: String(attachment)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Ручное преобразование массива прикреплений</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // attachment: [attachment].toString()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // attachment: String([attachment])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Можно передавать так же в массиве</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> api.messages.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">send</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    peer_id: &lt;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">peer_id</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">&gt;,</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // Здесь будет photo100_1,doc100_5</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    attachment: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        attachment,</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;doc100_5&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    ]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><div class="warning custom-block"><p class="custom-block-title">Внимание</p><p>Прикрепления могут содержать неполные данные, если например вы получаете их с User Long Poll. Проверить можно через <code>attachment.isFilled();</code></p></div><h2 id="получение-прикрепления-из-строки" tabindex="-1">Получение прикрепления из строки <a class="header-anchor" href="#получение-прикрепления-из-строки" aria-label="Permalink to &quot;Получение прикрепления из строки&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Attachment.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fromString</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;photo100_1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// =&gt; Attachment&lt;photo, 100, 1&gt;</span></span></code></pre></div><h2 id="можно-ли-прикрепить" tabindex="-1">Можно ли прикрепить <a class="header-anchor" href="#можно-ли-прикрепить" aria-label="Permalink to &quot;Можно ли прикрепить&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">attachment.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">canBeAttached</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// =&gt; boolean</span></span></code></pre></div><h2 id="сравнение-двух-прикреплении" tabindex="-1">Сравнение двух прикреплений <a class="header-anchor" href="#сравнение-двух-прикреплении" aria-label="Permalink to &quot;Сравнение двух прикреплений&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">attachment1.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(attachment2); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// =&gt; boolean</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Или</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">attachment1.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">equals</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;photo100_1&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// =&gt; boolean</span></span></code></pre></div><h2 id="полные-ли-данные-содержит-прикрепление" tabindex="-1">Полные ли данные содержит прикрепление <a class="header-anchor" href="#полные-ли-данные-содержит-прикрепление" aria-label="Permalink to &quot;Полные ли данные содержит прикрепление&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">attachment.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isFilled</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// =&gt; boolean</span></span></code></pre></div><h2 id="сериализация-прикрепления" tabindex="-1">Сериализация прикрепления <a class="header-anchor" href="#сериализация-прикрепления" aria-label="Permalink to &quot;Сериализация прикрепления&quot;">​</a></h2><div class="language-ts vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">ts</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(attachment); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// =&gt; object</span></span></code></pre></div>`,26),h=[n];function l(p,r,k,c,o,d){return i(),a("div",null,h)}const m=s(e,[["render",l]]);export{E as __pageData,m as default};
